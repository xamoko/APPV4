(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["avance-tarea-avance-tarea-module"],{/***/"./node_modules/raw-loader/dist/cjs.js!./src/app/pages/avance-tarea/avance-tarea.page.html":/*!*************************************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/app/pages/avance-tarea/avance-tarea.page.html ***!
  \*************************************************************************************************/ /*! exports provided: default */ /***/function node_modulesRawLoaderDistCjsJsSrcAppPagesAvanceTareaAvanceTareaPageHtml(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);/* harmony default export */__webpack_exports__["default"]="<ion-header>\n  <ion-toolbar color=\"primary\">\n\t\t<ion-buttons slot=\"start\">\n\t\t\t\t<ion-menu-button></ion-menu-button>\n\t\t\t  </ion-buttons>\n    <ion-title style=\"width: 100%;\n\t\theight: 100%;\n\t\ttext-align: center;\n\t\tpadding: unset\">\n\t\t\t<!-- <ion-icon style=\"font-size: 2.0em; margin-left:80%;\" ios=\"ios-attach\" md=\"md-add\" (click)=\"Open('photo')\"></ion-icon> -->\n\t\t\t<ion-icon style=\"font-size: 2.0em; margin-left:80%;\" ios=\"ios-attach\" md=\"md-add\" (click)=\"takePicturesCamera()\"></ion-icon>\n\t\t</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <ion-list>\n\t\t<ion-item *ngIf=\"registros == 0\">\n\t\t\t<div class=\"sec2\">\n\t\t\t\t<p class=\"fontPrimaria\" style=\"padding:20px;margin: 0px;\">\n\t\t\t\t\tAun no hay fotos de Avance que mostrar\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</ion-item>\n\n\t\t<ion-item style=\"padding: 20px;\" *ngFor=\"let item of todo | async\" >\n\t\t\t<!-- <div *ngIf=\"FBcode == item.identificador\"> -->\n\t\t\t\t<ion-item >\n\t\t\t<ion-avatar item-start style=\"border-radius: 0;\" (click)=\"Open('D', item)\">\n\t\t\t\t<img style=\"width: 200px; height: 150px; border: #FDC938 3px solid; border-radius: 0;\" [src]=\"item.url\">\n\t\t\t</ion-avatar>\n\t\t\t<ion-note item-end>\n\t\t\t\t<!-- <h3 style=\"font-size: 20px; color: #404040;\"><b>Nombre:</b> {{ registro.photoName }}</h3>\n\t\t\t\t<h3 style=\"font-size: 12px; color: #404040;\"><b>Descripci\xF3n:</b> {{ registro.description }}</h3>\n\t\t\t\t<h3 style=\"font-size: 12px; color: #404040;\"><b>Latitud:</b> {{ registro.geoLatitude }}</h3>\n\t\t\t\t<h3 style=\"font-size: 12px; color: #404040;\"><b>Longitud:</b> {{ registro.geoLongitude }}</h3> -->\n\t\t\t\t<h3 style=\"font-size: 12px; color: #404040;\"><b>\xBFQui\xE9n la subi\xF3?:</b> {{ item.nombre }}</h3>\n\t\t\t\t<!-- <h3 style=\"font-size: 12px; color: #404040;\"><b>Fecha - Hora:</b> {{ registro.creationDate }}</h3> -->\n\t\t\t</ion-note>\n\t\t\t\t</ion-item>\n\t\t<!-- </div> -->\n\t\t\n\t\t</ion-item>\n\t</ion-list>\n</ion-content>\n\n<ion-footer>\n  <ion-grid>\n    <ion-row>\n    <ion-col size=\"12\">\n      <ion-col size=\"6\">\n      <ion-icon class=\"icon-action-buttons\" name=\"camera\" (click)=\"takePicturesCamera()\" style=\"font-size: 30px;\"></ion-icon>\n      </ion-col>\n      <ion-col size=\"6\">\n      <ion-icon class=\"icon-action-buttons\" name=\"images\" (click)=\"takePicturesGallery()\" style=\"font-size: 30px;\"></ion-icon>\n      </ion-col>\n    </ion-col>\n    </ion-row>\n  </ion-grid>\n  </ion-footer>";/***/},/***/"./src/app/pages/avance-tarea/avance-tarea.module.ts":/*!***********************************************************!*\
  !*** ./src/app/pages/avance-tarea/avance-tarea.module.ts ***!
  \***********************************************************/ /*! exports provided: AvanceTareaPageModule */ /***/function srcAppPagesAvanceTareaAvanceTareaModuleTs(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);/* harmony export (binding) */__webpack_require__.d(__webpack_exports__,"AvanceTareaPageModule",function(){return AvanceTareaPageModule});/* harmony import */var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! tslib */"./node_modules/tslib/tslib.es6.js");/* harmony import */var _angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! @angular/core */"./node_modules/@angular/core/fesm2015/core.js");/* harmony import */var _angular_common__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(/*! @angular/common */"./node_modules/@angular/common/fesm2015/common.js");/* harmony import */var _angular_forms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(/*! @angular/forms */"./node_modules/@angular/forms/fesm2015/forms.js");/* harmony import */var _angular_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(/*! @angular/router */"./node_modules/@angular/router/fesm2015/router.js");/* harmony import */var _ionic_angular__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(/*! @ionic/angular */"./node_modules/@ionic/angular/dist/fesm5.js");/* harmony import */var _avance_tarea_page__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(/*! ./avance-tarea.page */"./src/app/pages/avance-tarea/avance-tarea.page.ts");var routes=[{path:"",component:_avance_tarea_page__WEBPACK_IMPORTED_MODULE_6__["AvanceTareaPage"]}];var AvanceTareaPageModule=function AvanceTareaPageModule(){};AvanceTareaPageModule=tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({imports:[_angular_common__WEBPACK_IMPORTED_MODULE_2__["CommonModule"],_angular_forms__WEBPACK_IMPORTED_MODULE_3__["FormsModule"],_ionic_angular__WEBPACK_IMPORTED_MODULE_5__["IonicModule"],_angular_router__WEBPACK_IMPORTED_MODULE_4__["RouterModule"].forChild(routes)],declarations:[_avance_tarea_page__WEBPACK_IMPORTED_MODULE_6__["AvanceTareaPage"]]})],AvanceTareaPageModule);/***/},/***/"./src/app/pages/avance-tarea/avance-tarea.page.scss":/*!***********************************************************!*\
  !*** ./src/app/pages/avance-tarea/avance-tarea.page.scss ***!
  \***********************************************************/ /*! exports provided: default */ /***/function srcAppPagesAvanceTareaAvanceTareaPageScss(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);/* harmony default export */__webpack_exports__["default"]="\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3BhZ2VzL2F2YW5jZS10YXJlYS9hdmFuY2UtdGFyZWEucGFnZS5zY3NzIn0= */";/***/},/***/"./src/app/pages/avance-tarea/avance-tarea.page.ts":/*!*********************************************************!*\
  !*** ./src/app/pages/avance-tarea/avance-tarea.page.ts ***!
  \*********************************************************/ /*! exports provided: AvanceTareaPage */ /***/function srcAppPagesAvanceTareaAvanceTareaPageTs(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);/* harmony export (binding) */__webpack_require__.d(__webpack_exports__,"AvanceTareaPage",function(){return AvanceTareaPage});/* harmony import */var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(/*! tslib */"./node_modules/tslib/tslib.es6.js");/* harmony import */var _angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(/*! @angular/core */"./node_modules/@angular/core/fesm2015/core.js");/* harmony import */var _ionic_native_camera_ngx__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(/*! @ionic-native/camera/ngx */"./node_modules/@ionic-native/camera/ngx/index.js");/* harmony import */var _ionic_native_geolocation_ngx__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(/*! @ionic-native/geolocation/ngx */"./node_modules/@ionic-native/geolocation/ngx/index.js");/* harmony import */var _angular_http__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(/*! @angular/http */"./node_modules/@angular/http/fesm2015/http.js");/* harmony import */var angularfire2_firestore__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(/*! angularfire2/firestore */"./node_modules/angularfire2/firestore/index.js");/* harmony import */var angularfire2_firestore__WEBPACK_IMPORTED_MODULE_5___default=/*#__PURE__*/__webpack_require__.n(angularfire2_firestore__WEBPACK_IMPORTED_MODULE_5__);/* harmony import */var _angular_fire_storage__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(/*! @angular/fire/storage */"./node_modules/@angular/fire/storage/es2015/index.js");/* harmony import */var rxjs_operators__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(/*! rxjs/operators */"./node_modules/rxjs/_esm2015/operators/index.js");/* harmony import */var _angular_router__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(/*! @angular/router */"./node_modules/@angular/router/fesm2015/router.js");/* harmony import */var _services_sqlite_sqlite__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(/*! ../../services/sqlite/sqlite */"./src/app/services/sqlite/sqlite.ts");/* harmony import */var _ionic_angular__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(/*! @ionic/angular */"./node_modules/@ionic/angular/dist/fesm5.js");var AvanceTareaPage=/*#__PURE__*/function(){function AvanceTareaPage(camera,http,route,router,sqliteService,firestore,navCtrl,geolocation,storage){this.camera=camera;this.http=http;this.route=route;this.router=router;this.sqliteService=sqliteService;this.firestore=firestore;this.navCtrl=navCtrl;this.geolocation=geolocation;this.storage=storage;this.ip2="http://198.50.116.250/service_network_API/public/index.php/api";this.Image=[];this.base64Image=[]}var _proto=AvanceTareaPage.prototype;_proto.ngOnInit=function ngOnInit(){this.items=this.route.snapshot.params;/* this.item = this.items.data.item;
            this.evidencia = this.items.data.evidencia;
        this.FBcode = this.items.data.item; */var taskId=this.sqliteService.GetTareaId();this.collection=this.firestore.collection("fotosAvance/"+taskId+"/fotos");this.todo=this.collection.valueChanges()};_proto.LoadDatas=function LoadDatas(){var _this=this;this.ip=this.sqliteService.ip;this.token=this.sqliteService.token;//let url = "";
//if (typeof this.evidencia !== "undefined")  {
//url = this.ip + `/evidence_photo`;
//url = this.ip + `/evidenceTask`;
var url="http://198.50.116.250/service_network_API/public/index.php/api/getPhotosByPojectId";var headers2=new _angular_http__WEBPACK_IMPORTED_MODULE_4__["Headers"];headers2.append("Content-Type","application/json");headers2.append("Access-Control-Allow-Origin","*");headers2.append("Access-Control-Allow-Methods","POST, GET, OPTIONS, PUT");headers2.append("Content-Type","application/x-www-form-urlencoded");headers2.append("Authorization","Bearer "+this.token);// let data = {
//   idEvidence: this.evidencia.evidence_id,
//   idTask: this.item.id
// };
var ProjectId=this.sqliteService.GerProjectId();var tipoFoto=this.sqliteService.GerTipoFoto();var data={project_id:ProjectId,task_id:this.items.tareaId,photo_type_id:tipoFoto};console.log("data: "+JSON.stringify(data));this.http.post(url,JSON.stringify(data),{headers:headers2}).subscribe(function(data){_this.registros=data.json();console.log("Registros_1: "+JSON.stringify(_this.registros));//this.registros = Array.of(this.registros);
//console.log("Registros_2: " + JSON.stringify(this.registros));
/* var registross = data.json(); */ //this.registros = Array.of(this.registross);
/* resultado.foreach(element =>{
               this.registros = element.url;
               this.registros = element.creation_date;
               console.log("url: "+element.url);
               console.log("creation_date: "+element.creation_date);
            }); */ /* this.registros = Object.keys(registross).map(function(key) {
              return [registross[key]];
            });
            console.log("Registros: "+this.registros);
          }); */ /*  }
             else{
               console.log("Entra a Avance");
         
               //url = this.ip2 + `/foto/${this.item.tareaId}`;
               url = this.ip2 + `/getPhotosByPojectId`;
         
               let headers2 = new Headers();
         
               let ProjectId = this.sqliteService.GerProjectId();
               let tipoFoto = this.sqliteService.GerTipoFoto();
         
               let data = {
                 project_id: ProjectId,
                 task_id: this.item.tareaId,
                 photo_type_id: tipoFoto
               };
         
         
               headers2.append('Accept','application/json');
               headers2.append('content-type','application/json');
               headers2.append('Authorization','Bearer '+this.token);
               this.http.post(url, JSON.stringify(data), {headers: headers2}).subscribe(data => {
                 this.registros = data.json();
               });*/});// console.log(this.item);
// console.log(data.json());
};_proto.takePicturesCamera=function takePicturesCamera(){return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee(){var _this2=this;var options,result,image,a,tareaid,idd,file,filePath,pictures,task,tar;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:options={quality:100,destinationType:this.camera.DestinationType.DATA_URL,/* sourceType: this.camera.PictureSourceType.PHOTOLIBRARY, */encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,targetWidth:1024,targetHeight:768,saveToPhotoAlbum:true,correctOrientation:true,allowEdit:true};this.geolocation.getCurrentPosition().then(function(resp){console.log("Coordenadas 1: "+resp.coords.latitude,resp.coords.longitude);_this2.longitud=resp.coords.longitude;_this2.latitud=resp.coords.latitude}).catch(function(error){console.log("Error getting location",error)});_context.next=4;return this.camera.getPicture(options);case 4:result=_context.sent;image="data:image/jpeg;base64,"+result;a=Date();tareaid=this.sqliteService.GetTareaId();idd=Math.random().toString(36).substring(2);/* const file = this.Image[0].image; */file="data:image/jpeg;base64,"+result;filePath="fotosAvance/"+tareaid+"/"+idd;/* const ref = this.storage.ref(filePath);
        const task = this.storage.upload(filePath, file); */pictures=this.storage.ref(filePath);task=pictures.putString(image,"data_url");pictures.getDownloadURL().subscribe(function(ur){console.log("nueva funcion: "+ur)});console.log("a punto de entrar");tar=parseFloat(tareaid);task.snapshotChanges().pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_7__["finalize"])(function(){return pictures.getDownloadURL().subscribe(function(url){_this2.datas={key:idd,nombre:"Foto de avance de la tarea: "+_this2.item.nombreTarea+". Foto desde la c\xE1mara",url:url,idTarea:tar,usuario:_this2.sqliteService.GerUserId(),latitud:_this2.latitud,longitud:_this2.longitud};console.log(JSON.stringify(_this2.datas));_this2.firestore.collection("fotosAvance").doc(""+tar).collection("fotos").add(_this2.datas)})})).subscribe();case 17:case"end":return _context.stop();}}},_callee,this)}))};_proto.takePicturesGallery=function takePicturesGallery(){return tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"](this,void 0,void 0,/*#__PURE__*/regeneratorRuntime.mark(function _callee2(){var _this3=this;var options,result,image,a,tareaid,idd,file,filePath,pictures,task,tar;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:options={quality:100,destinationType:this.camera.DestinationType.DATA_URL,sourceType:this.camera.PictureSourceType.PHOTOLIBRARY,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,targetWidth:1024,targetHeight:768,saveToPhotoAlbum:true,correctOrientation:true,allowEdit:true};this.geolocation.getCurrentPosition().then(function(resp){console.log("Coordenadas 1: "+resp.coords.latitude,resp.coords.longitude);_this3.latitud=resp.coords.latitude,_this3.longitud=resp.coords.longitude}).catch(function(error){console.log("Error getting location",error)});_context2.next=4;return this.camera.getPicture(options);case 4:result=_context2.sent;image="data:image/jpeg;base64,"+result;a=Date();tareaid=this.sqliteService.GetTareaId();idd=Math.random().toString(36).substring(2);/* const file = this.Image[0].image; */file="data:image/jpeg;base64,"+result;filePath="fotosAvance/"+tareaid+"/"+idd;/* const ref = this.storage.ref(filePath);
        const task = this.storage.upload(filePath, file); */pictures=this.storage.ref(filePath);task=pictures.putString(image,"data_url");pictures.getDownloadURL().subscribe(function(ur){console.log("nueva funcion: "+ur)});console.log("a punto de entrar");tar=parseFloat(tareaid);task.snapshotChanges().pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_7__["finalize"])(function(){return pictures.getDownloadURL().subscribe(function(url){_this3.datas={key:idd,nombre:"Foto de avance de la tarea: "+_this3.item.nombreTarea+". Foto desde la galer\xEDa",url:url,idTarea:tar,latitud:_this3.latitud,longitud:_this3.longitud};console.log(JSON.stringify(_this3.datas));_this3.firestore.collection("fotosAvance").doc(""+tar).collection("fotos").add(_this3.datas)})})).subscribe();case 17:case"end":return _context2.stop();}}},_callee2,this)}))};_proto.Open=function Open(page,registro){var item=this.items;switch(page){case"photo":{/* this.navCtrl.push(NuevoregistroPage, { item: item }); */break}case"photoGallery":{/* this.navCtrl.push(Nuevoregistro2Page, { item: item }); */break}case"D":{this.navCtrl.navigateForward(["/menu/first/detalle-foto-avance",registro]);//this.router.navigate(['/menu/first/detalle-foto-avance' ,registro]);
break}}};return AvanceTareaPage}();AvanceTareaPage.ctorParameters=function(){return[{type:_ionic_native_camera_ngx__WEBPACK_IMPORTED_MODULE_2__["Camera"]},{type:_angular_http__WEBPACK_IMPORTED_MODULE_4__["Http"]},{type:_angular_router__WEBPACK_IMPORTED_MODULE_8__["ActivatedRoute"]},{type:_angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"]},{type:_services_sqlite_sqlite__WEBPACK_IMPORTED_MODULE_9__["SqliteProvider"]},{type:angularfire2_firestore__WEBPACK_IMPORTED_MODULE_5__["AngularFirestore"]},{type:_ionic_angular__WEBPACK_IMPORTED_MODULE_10__["NavController"]},{type:_ionic_native_geolocation_ngx__WEBPACK_IMPORTED_MODULE_3__["Geolocation"]},{type:_angular_fire_storage__WEBPACK_IMPORTED_MODULE_6__["AngularFireStorage"]}]};AvanceTareaPage=tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"]([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({selector:"app-avance-tarea",template:tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! raw-loader!./avance-tarea.page.html */"./node_modules/raw-loader/dist/cjs.js!./src/app/pages/avance-tarea/avance-tarea.page.html")).default,styles:[tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"](__webpack_require__(/*! ./avance-tarea.page.scss */"./src/app/pages/avance-tarea/avance-tarea.page.scss")).default]}),tslib__WEBPACK_IMPORTED_MODULE_0__["__metadata"]("design:paramtypes",[_ionic_native_camera_ngx__WEBPACK_IMPORTED_MODULE_2__["Camera"],_angular_http__WEBPACK_IMPORTED_MODULE_4__["Http"],_angular_router__WEBPACK_IMPORTED_MODULE_8__["ActivatedRoute"],_angular_router__WEBPACK_IMPORTED_MODULE_8__["Router"],_services_sqlite_sqlite__WEBPACK_IMPORTED_MODULE_9__["SqliteProvider"],angularfire2_firestore__WEBPACK_IMPORTED_MODULE_5__["AngularFirestore"],_ionic_angular__WEBPACK_IMPORTED_MODULE_10__["NavController"],_ionic_native_geolocation_ngx__WEBPACK_IMPORTED_MODULE_3__["Geolocation"],_angular_fire_storage__WEBPACK_IMPORTED_MODULE_6__["AngularFireStorage"]])],AvanceTareaPage);/***/}}]);//# sourceMappingURL=avance-tarea-avance-tarea-module-es2015.js.map
//# sourceMappingURL=avance-tarea-avance-tarea-module-es5.js.map